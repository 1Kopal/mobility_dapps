# The car-sharing car dapp.

This dapp/carsharing service is built for the car node in the car sharing application.

## Hardware requirements

- Raspberry Pi 3
- GPS module
- Keyforb bridge circuit

## Usage

### Configuration files

First we need the car information json file to bootstrap car profile. The example 
format of the file "car-config.json"

```json
{
    "OakenTestCar": {
        "vin": "J888888",
        "year": 2020,
        "make": "Oaken",
        "model": "voyage",
        "color": "gold",
        "transmission": "ai",
        "seats": 4
    }
}
```

For bootstrap smart contract instance, it requires to have the contract artifacts 
generated by `truffle compile`.

To bootstrap web3 and ethereum account, it requires the HD configuration for the 
wallet and network. The example "hdconfig.json" file.

```
{
    "mnemonic": "your HD wallet mnemonic (12) words",
    "accounts": {
        "truffle": {
           "index": 0,
           "address": "0x..."
        },
        "car": {
            "index": 1,
            "address": "0x..."
        },
        "user": {
            "index": 2,
            "address": ""
        },
        "owner": {
            "index": 3,
            "address": ""
        }
    },
    "rpcs": {
        "testrpc": {
            "protocol": "http",
            "host": "localhost",
            "port": 8545,
            "HD": false
        },
        "geth": {
            "protocol": "ipc",
            "host": "$HOME/.ethereum/testnet/geth.ipc",
            "HD": false 
        },
        "infura": {
            "protocol": "https",
            "host": "ropsten.infura.io",
            "HD": true
        }
    }

}
```

### Run

`node carsharing-car.js`, you will see the startup printout message

```bash
RPC infura connected at https://ropsten.infura.io
Using HD account 1: 0x3b7f58b6ae8643dac0ac16560b7b38991cdec338.
Constract deployed at 0xffbd7fe1faffce875e0f32ae64d37ca9968de24f

IPFS node id QmdywW3hLj6ztujWyei3b3192kGtPNpKgXAyzEdBBridfA

Subscribed to carsharing-car-commands-topic from MQTT.

CarSharing Dapp [car] node booted!

Start sharing GPS data.
Node subscribed to /mqttt/0x3b7f58b6ae8643dac0ac16560b7b38991cdec338
```


